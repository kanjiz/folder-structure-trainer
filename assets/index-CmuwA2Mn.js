(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}})();const I=[{id:"q001",title:"ä»•äº‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã‚ˆã†",mode:"practice",instructions:["ã€Œå ±å‘Šæ›¸.docxã€ã‚’ã€Œä»•äº‹ã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€Œè­°äº‹éŒ².txtã€ã‚’ã€Œä»•äº‹ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã®ã€Œä¼šè­°ã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€ŒçŒ«.jpgã€ã‚’ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„"],items:[{id:"f1",name:"ä»•äº‹",type:"folder"},{id:"f2",name:"ä¼šè­°",type:"folder"},{id:"f3",name:"ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ",type:"folder"},{id:"d1",name:"å ±å‘Šæ›¸.docx",type:"file"},{id:"d2",name:"è­°äº‹éŒ².txt",type:"file"},{id:"d3",name:"çŒ«.jpg",type:"file"}],answer:{ä»•äº‹:{type:"folder",children:{ä¼šè­°:{type:"folder",children:{"è­°äº‹éŒ².txt":{type:"file"}}},"å ±å‘Šæ›¸.docx":{type:"file"}}},ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ:{type:"folder",children:{"çŒ«.jpg":{type:"file"}}}}},{id:"q002",title:"å­¦æ ¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã‚ˆã†",mode:"exercise",instructions:["ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã«æ•´ç†ã—ã¦ãã ã•ã„","ã€Œèª­æ›¸æ„Ÿæƒ³æ–‡.docxã€ã¨ã€Œæ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdfã€ã¯ã€Œå›½èªã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€Œè¨ˆç®—ãƒ‰ãƒªãƒ«.xlsxã€ã¯ã€Œæ•°å­¦ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã®ã€Œå®¿é¡Œã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„"],items:[{id:"f1",name:"å›½èª",type:"folder"},{id:"f2",name:"æ•°å­¦",type:"folder"},{id:"f3",name:"å®¿é¡Œ",type:"folder"},{id:"d1",name:"èª­æ›¸æ„Ÿæƒ³æ–‡.docx",type:"file"},{id:"d2",name:"è¨ˆç®—ãƒ‰ãƒªãƒ«.xlsx",type:"file"},{id:"d3",name:"æ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdf",type:"file"}],answer:{å›½èª:{type:"folder",children:{"èª­æ›¸æ„Ÿæƒ³æ–‡.docx":{type:"file"},"æ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdf":{type:"file"}}},æ•°å­¦:{type:"folder",children:{å®¿é¡Œ:{type:"folder",children:{"è¨ˆç®—ãƒ‰ãƒªãƒ«.xlsx":{type:"file"}}}}}}}];function S(n,e,r){const i=document.createElement("div");i.className="select-view",i.innerHTML="<h1>ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼</h1><p>å•é¡Œã‚’é¸ã‚“ã§ãã ã•ã„</p>";const t=document.createElement("div");t.className="question-list";for(const o of e){const s=document.createElement("button");s.className="question-card";const l=o.mode==="practice"?"ç·´ç¿’":"æ¼”ç¿’";s.innerHTML=`
      <span class="mode-badge mode-${o.mode}">${l}</span>
      <span class="question-title">${o.title}</span>
    `,s.addEventListener("click",()=>r(o)),t.appendChild(s)}i.appendChild(t),n.appendChild(i)}class L{id;name;type;parent=null;children=[];constructor(e,r,i){this.id=e,this.name=r,this.type=i}addChild(e){if(this.type!=="folder")throw new Error("Cannot add child to a file");if(e.parent===this)return;let r=this.parent;for(;r;){if(r===e)throw new Error("Cannot create circular reference");r=r.parent}e.parent?.removeChild(e),e.parent=this,this.children.push(e)}removeChild(e){this.children=this.children.filter(r=>r!==e),e.parent=null}}class O{root;allNodes;constructor(){this.root=new L("root","root","folder"),this.allNodes=new Map}loadQuestion(e){this.root=new L("root","root","folder"),this.allNodes=new Map;for(const r of e.items){const i=new L(r.id,r.name,r.type);this.allNodes.set(r.id,i),this.root.addChild(i)}}moveNode(e,r){const i=this.allNodes.get(e),t=r==="root"?this.root:this.allNodes.get(r);return!i||!t||t.type!=="folder"?!1:(t.addChild(i),!0)}buildCurrentTree(e=this.root){const r={};for(const i of e.children)i.type==="folder"?r[i.name]={type:"folder",children:this.buildCurrentTree(i)}:r[i.name]={type:"file"};return r}checkAnswer(e){const r=[],i=[];return this.compareTree(this.root,e,r,i),{correct:r,incorrect:i}}compareTree(e,r,i,t){for(const o of e.children)if(o.name in r){const s=r[o.name];o.type===s.type?(i.push(o.id),o.type==="folder"&&s.children&&this.compareTree(o,s.children,i,t)):t.push(o.id)}else t.push(o.id)}checkSingleMove(e,r){const i=this.allNodes.get(e);if(!i||!i.parent)return!1;const t=i.parent===this.root?null:i.parent.name;return this.getAnswerAncestors(i.name,i.type,r,[null]).includes(t)}getAnswerAncestors(e,r,i,t){for(const[o,s]of Object.entries(i)){if(o===e&&s.type===r)return t;if(s.type==="folder"&&s.children){const l=this.getAnswerAncestors(e,r,s.children,[...t,o]);if(l.length>0)return l}}return[]}}class F{selection;clipboard;currentFolder;lastSelectedId=null;constructor(e){this.selection=new Set,this.clipboard=new Set,this.currentFolder=e}toggleSelection(e){this.selection.has(e)?this.selection.delete(e):this.selection.add(e)}isSelected(e){return this.selection.has(e)}clearSelection(){this.selection.clear()}cut(){this.clipboard=new Set(this.selection),this.selection.clear()}clearClipboard(){this.clipboard.clear()}navigateToFolder(e){if(e.type!=="folder")throw new Error("Cannot navigate to a file");this.currentFolder=e}selectRange(e,r,i){const t=e.indexOf(r),o=e.indexOf(i);if(t===-1||o===-1)return;const[s,l]=t<o?[t,o]:[o,t];this.selection.clear();for(let d=s;d<=l;d++)this.selection.add(e[d])}setLastSelected(e){this.lastSelectedId=e}getLastSelected(){return this.lastSelectedId}getSelectedIds(){return Array.from(this.selection)}}function P(n,e,r){T(n,e,r)}function T(n,e,r){n.innerHTML="";const i=document.createElement("ul");i.className="tree-list",i.setAttribute("role","tree");const t=document.createElement("li");t.className="tree-item tree-folder",t.dataset.nodeId=e.root.id,t.setAttribute("role","treeitem"),t.setAttribute("aria-label","Desktop (ãƒ•ã‚©ãƒ«ãƒ€)"),t.setAttribute("aria-expanded","true");const o="ğŸ“";t.textContent=`${o} Desktop`,t.addEventListener("dragover",s=>{D(s,t)}),t.addEventListener("dragleave",s=>{A(s,t)}),t.addEventListener("drop",s=>{$(s,e.root.id,t,e,r)}),e.root.children.length>0&&t.appendChild(k(e.root,e,r)),i.appendChild(t),n.appendChild(i)}function k(n,e,r){const i=document.createElement("ul");i.className="tree-list",i.setAttribute("role","tree");for(const t of n.children){const o=document.createElement("li");o.className=`tree-item tree-${t.type}`,o.dataset.nodeId=t.id,o.setAttribute("role","treeitem"),o.setAttribute("aria-label",`${t.name} (${t.type==="folder"?"ãƒ•ã‚©ãƒ«ãƒ€":"ãƒ•ã‚¡ã‚¤ãƒ«"})`),t.type==="folder"&&o.setAttribute("aria-expanded",t.children.length>0?"true":"false");const s=t.type==="folder"?"ğŸ“":"ğŸ“„";o.textContent=`${s} ${t.name}`,t.type==="folder"&&(o.addEventListener("dragover",l=>{D(l,o)}),o.addEventListener("dragleave",l=>{A(l,o)}),o.addEventListener("drop",l=>{$(l,t.id,o,e,r)}),t.children.length>0&&o.appendChild(k(t,e,r))),i.appendChild(o)}return i}function D(n,e){n.preventDefault(),n.stopPropagation(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",e.classList.add("drop-target"))}function A(n,e){n.stopPropagation();const r=e.getBoundingClientRect(),i=n.clientX,t=n.clientY;(i<=r.left||i>=r.right||t<=r.top||t>=r.bottom)&&e.classList.remove("drop-target")}function $(n,e,r,i,t){if(n.preventDefault(),n.stopPropagation(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==e&&i.moveNode(s,e);t&&t()}catch(o){console.error("Tree drop failed:",o)}}function x(n,e,r,i,t){n.innerHTML="",n.classList.add("breadcrumb-view"),n.setAttribute("role","navigation"),n.setAttribute("aria-label","ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ");const s=H(e,r).split(" > "),l=V(e,r);s.forEach((d,a)=>{const c=document.createElement("span");if(c.className="breadcrumb-item",c.textContent=d,c.dataset.depth=a.toString(),c.dataset.folderId=l[a].id,c.setAttribute("role","button"),c.setAttribute("aria-label",`${d}ã«ç§»å‹•`),c.tabIndex=0,c.addEventListener("click",()=>{i(l[a])}),c.addEventListener("dragover",p=>{q(p,c)}),c.addEventListener("dragleave",p=>{K(p,c)}),c.addEventListener("drop",p=>{B(p,l[a].id,c,r,t)}),n.appendChild(c),a<s.length-1){const p=document.createElement("span");p.className="breadcrumb-separator",p.textContent=" > ",n.appendChild(p)}})}function H(n,e){const r=[];let i=n;for(;i&&i!==e.root;)r.unshift(i.name),i=i.parent;return r.unshift("Desktop"),r.join(" > ")}function V(n,e){const r=[];let i=n;for(;i&&i!==e.root;)r.unshift(i),i=i.parent;return r.unshift(e.root),r}function q(n,e){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",e.classList.add("drop-target"))}function K(n,e){e.classList.remove("drop-target")}function B(n,e,r,i,t){if(n.preventDefault(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==e&&i.moveNode(s,e);t&&t()}catch(o){console.error("Breadcrumb drop failed:",o)}}let h=null;function M(n){y();const e=document.createElement("div");e.className="context-menu",e.style.left=`${n.x}px`,e.style.top=`${n.y}px`,n.items.forEach(t=>{const o=document.createElement("div");o.className="context-menu-item",t.disabled&&o.classList.add("disabled"),o.textContent=t.label,o.addEventListener("click",s=>{s.stopPropagation(),t.disabled||(t.onClick(),y())}),e.appendChild(o)}),document.body.appendChild(e),h=e;const r=e.getBoundingClientRect();r.right>window.innerWidth&&(e.style.left=`${window.innerWidth-r.width-10}px`),r.bottom>window.innerHeight&&(e.style.top=`${window.innerHeight-r.height-10}px`);const i=t=>{e.contains(t.target)||(y(),document.removeEventListener("click",i))};setTimeout(()=>{document.addEventListener("click",i)},0)}function y(){h&&h.parentNode&&(h.parentNode.removeChild(h),h=null)}let m=null;function N(n,e,r,i){n.tabIndex=0,R(n,e,r,i),U(n,e,r,i),_(n,r,e,i),Z(n,r,i)}function R(n,e,r,i){const o=document.activeElement?.dataset?.nodeId;if(n.innerHTML="",n.className="icon-view-dom",r.currentFolder.children.forEach(l=>{const d=j(l,r,e,i);n.appendChild(d)}),o){const l=n.querySelector(`[data-node-id="${o}"]`);if(l){l.focus();return}}n.focus()}function j(n,e,r,i){const t=document.createElement("div");t.className="icon-item",t.dataset.nodeId=n.id,t.tabIndex=0,t.draggable=!0,t.setAttribute("role","button"),t.setAttribute("aria-label",`${n.name} (${n.type==="folder"?"ãƒ•ã‚©ãƒ«ãƒ€":"ãƒ•ã‚¡ã‚¤ãƒ«"})`),t.setAttribute("aria-selected",e.isSelected(n.id).toString()),e.isSelected(n.id)&&t.classList.add("selected");const o=document.createElement("div");o.className="icon-symbol",o.textContent=n.type==="folder"?"ğŸ“":"ğŸ“„",t.appendChild(o);const s=document.createElement("div");return s.className="icon-name",s.textContent=n.name,t.appendChild(s),t.addEventListener("click",l=>{t.focus(),z(n.id,l,e,r,i)}),t.addEventListener("dblclick",()=>{n.type==="folder"&&(e.navigateToFolder(n),i())}),t.addEventListener("dragstart",l=>{X(l,n.id,e)}),t.addEventListener("contextmenu",l=>{l.preventDefault(),W(l,n.id,e,r,i)}),n.type==="folder"&&(t.addEventListener("dragover",l=>{Y(l,t)}),t.addEventListener("dragleave",l=>{Q(l,t)}),t.addEventListener("drop",l=>{G(l,n.id,t,r,i)})),t}function z(n,e,r,i,t){const s=r.currentFolder.children.map(l=>l.id);if(e.ctrlKey||e.metaKey)r.toggleSelection(n),r.setLastSelected(n);else if(e.shiftKey){const l=r.getLastSelected();l?r.selectRange(s,l,n):(r.clearSelection(),r.toggleSelection(n)),r.setLastSelected(n)}else r.clearSelection(),r.toggleSelection(n),r.setLastSelected(n);t()}function J(n,e){const r=document.createElement("div");r.className="drag-preview";const i=3,t=Math.min(n.length,i);for(let o=0;o<t;o++){const s=e.currentFolder.children.find(c=>c.id===n[o]);if(!s)continue;const l=document.createElement("div");l.className="drag-preview-item",l.style.top=`${o*4}px`,l.style.left=`${o*4}px`;const d=document.createElement("span");d.className="drag-preview-icon",d.textContent=s.type==="folder"?"ğŸ“":"ğŸ“„",l.appendChild(d);const a=document.createElement("span");a.className="drag-preview-name",a.textContent=s.name,l.appendChild(a),r.appendChild(l)}if(n.length>i){const o=document.createElement("div");o.className="drag-preview-badge",o.textContent=`+${n.length-i}`,r.appendChild(o)}return r}function X(n,e,r){if(!n.dataTransfer)return;let i;r.isSelected(e)?i=r.getSelectedIds():i=[e],n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",JSON.stringify(i));const t=J(i,r);document.body.appendChild(t),n.dataTransfer.setDragImage(t,10,10),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},0)}function Y(n,e){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",e.classList.add("drop-target"))}function Q(n,e){const r=e.getBoundingClientRect(),i=n.clientX,t=n.clientY;(i<=r.left||i>=r.right||t<=r.top||t>=r.bottom)&&e.classList.remove("drop-target")}function G(n,e,r,i,t){if(n.preventDefault(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==e&&i.moveNode(s,e);t()}catch(o){console.error("Drop failed:",o)}}function W(n,e,r,i,t){r.isSelected(e)||(r.clearSelection(),r.toggleSelection(e),r.setLastSelected(e),t()),M({x:n.clientX,y:n.clientY,items:[{label:"åˆ‡ã‚Šå–ã‚Š",onClick:()=>{r.cut(),t()}},{label:"è²¼ã‚Šä»˜ã‘",disabled:r.clipboard.size===0,onClick:()=>{C(r,i,t)}}]})}function _(n,e,r,i){n.addEventListener("contextmenu",t=>{t.target.closest(".icon-item")||(t.preventDefault(),M({x:t.clientX,y:t.clientY,items:[{label:"è²¼ã‚Šä»˜ã‘",disabled:e.clipboard.size===0,onClick:()=>{C(e,r,i)}}]}))})}function Z(n,e,r){n.addEventListener("click",i=>{i.target.closest(".icon-item")||e.selection.size>0&&(e.clearSelection(),r())})}function U(n,e,r,i){m&&n.removeEventListener("keydown",m),m=t=>{(t.ctrlKey||t.metaKey)&&t.key==="x"&&(t.preventDefault(),r.selection.size>0&&(r.cut(),i())),(t.ctrlKey||t.metaKey)&&t.key==="v"&&(t.preventDefault(),r.clipboard.size>0&&C(r,e,i))},n.addEventListener("keydown",m)}function C(n,e,r){const i=Array.from(n.clipboard),t=n.currentFolder.id==="root"?"root":n.currentFolder.id;for(const o of i)e.moveNode(o,t);n.clearClipboard(),r()}function ee(n){m&&(n.removeEventListener("keydown",m),m=null),y()}let f=null,u=null,w=null;function te(n,e,r,i){f=new O,f.loadQuestion(e),u=new F(f.root);const t=document.createElement("div");t.className="game-view",t.innerHTML=`
    <div class="instruction-area">
      <h2>${e.title}</h2>
      <ul class="instructions">
        ${e.instructions.map(c=>`<li>${c}</li>`).join("")}
      </ul>
    </div>
    <div class="main-area">
      <div class="breadcrumb-panel" id="breadcrumb-panel"></div>
      <div class="tree-panel" id="tree-panel"></div>
      <div class="icon-panel" id="icon-panel"></div>
    </div>
    <div class="action-area">
      ${e.mode==="exercise"?'<button id="check-btn" class="btn-primary">ç­”ãˆåˆã‚ã›</button>':""}
      <button id="back-btn" class="btn-secondary">å•é¡Œé¸æŠã«æˆ»ã‚‹</button>
    </div>
  `,n.appendChild(t);const o=t.querySelector("#breadcrumb-panel"),s=t.querySelector("#tree-panel"),l=t.querySelector("#icon-panel");w=l;const d=c=>{u.navigateToFolder(c),a()},a=()=>{if(x(o,u.currentFolder,f,d,a),T(s,f,a),N(l,f,u,a),e.mode==="practice"){const c=f.checkAnswer(e.answer);c.incorrect.length===0&&c.correct.length>0&&r(c)}};x(o,u.currentFolder,f,d,a),P(s,f,a),N(l,f,u,a),e.mode==="exercise"&&t.querySelector("#check-btn").addEventListener("click",()=>{const c=f.checkAnswer(e.answer);r(c)}),t.querySelector("#back-btn").addEventListener("click",i)}function re(){w&&(ee(w),w=null),f=null,u=null}function ne(n,e,r,i,t){const o=r.correct.length+r.incorrect.length,s=r.correct.length,l=document.createElement("div");l.className="result-view",l.innerHTML=`
    <h2>çµæœ</h2>
    <p class="score">${s} / ${o} æ­£è§£</p>
    <div class="result-items">
      ${e.items.map(d=>{const a=r.correct.includes(d.id);return`<div class="result-item ${a?"result-correct":"result-incorrect"}"><span>${a?"âœ“":"âœ—"}</span> ${d.name}</div>`}).join("")}
    </div>
    <div class="result-actions">
      <button id="retry-btn" class="btn-primary">ã‚‚ã†ä¸€åº¦</button>
      <button id="select-btn" class="btn-secondary">å•é¡Œé¸æŠã«æˆ»ã‚‹</button>
    </div>
  `,n.appendChild(l),l.querySelector("#retry-btn").addEventListener("click",t),l.querySelector("#select-btn").addEventListener("click",i)}let b=null,E=null;const v=document.querySelector("#app");function g(n){switch(re(),v.innerHTML="",n){case"select":S(v,I,e=>{b=e,g("game")});break;case"game":b&&te(v,b,e=>{E=e,g("result")},()=>g("select"));break;case"result":b&&E&&ne(v,b,E,()=>g("select"),()=>g("game"));break}}g("select");
