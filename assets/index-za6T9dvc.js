(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(e){if(e.ep)return;e.ep=!0;const o=r(e);fetch(e.href,o)}})();const I=[{id:"q001",title:"ä»•äº‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã‚ˆã†",mode:"practice",instructions:["ã€Œå ±å‘Šæ›¸.docxã€ã‚’ã€Œä»•äº‹ã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€Œè­°äº‹éŒ².txtã€ã‚’ã€Œä»•äº‹ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã®ã€Œä¼šè­°ã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€ŒçŒ«.jpgã€ã‚’ã€Œãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„"],items:[{id:"f1",name:"ä»•äº‹",type:"folder"},{id:"f2",name:"ä¼šè­°",type:"folder"},{id:"f3",name:"ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ",type:"folder"},{id:"d1",name:"å ±å‘Šæ›¸.docx",type:"file"},{id:"d2",name:"è­°äº‹éŒ².txt",type:"file"},{id:"d3",name:"çŒ«.jpg",type:"file"}],answer:{ä»•äº‹:{type:"folder",children:{ä¼šè­°:{type:"folder",children:{"è­°äº‹éŒ².txt":{type:"file"}}},"å ±å‘Šæ›¸.docx":{type:"file"}}},ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ:{type:"folder",children:{"çŒ«.jpg":{type:"file"}}}}},{id:"q002",title:"å­¦æ ¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã‚ˆã†",mode:"exercise",instructions:["ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã«æ•´ç†ã—ã¦ãã ã•ã„","ã€Œèª­æ›¸æ„Ÿæƒ³æ–‡.docxã€ã¨ã€Œæ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdfã€ã¯ã€Œå›½èªã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„","ã€Œè¨ˆç®—ãƒ‰ãƒªãƒ«.xlsxã€ã¯ã€Œæ•°å­¦ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã®ã€Œå®¿é¡Œã€ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã‚Œã¦ãã ã•ã„"],items:[{id:"f1",name:"å›½èª",type:"folder"},{id:"f2",name:"æ•°å­¦",type:"folder"},{id:"f3",name:"å®¿é¡Œ",type:"folder"},{id:"d1",name:"èª­æ›¸æ„Ÿæƒ³æ–‡.docx",type:"file"},{id:"d2",name:"è¨ˆç®—ãƒ‰ãƒªãƒ«.xlsx",type:"file"},{id:"d3",name:"æ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdf",type:"file"}],answer:{å›½èª:{type:"folder",children:{"èª­æ›¸æ„Ÿæƒ³æ–‡.docx":{type:"file"},"æ¼¢å­—ãƒ†ã‚¹ãƒˆ.pdf":{type:"file"}}},æ•°å­¦:{type:"folder",children:{å®¿é¡Œ:{type:"folder",children:{"è¨ˆç®—ãƒ‰ãƒªãƒ«.xlsx":{type:"file"}}}}}}}];function S(n,t,r){const i=document.createElement("div");i.className="select-view",i.innerHTML="<h1>ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼</h1><p>å•é¡Œã‚’é¸ã‚“ã§ãã ã•ã„</p>";const e=document.createElement("div");e.className="question-list";for(const o of t){const s=document.createElement("button");s.className="question-card";const l=o.mode==="practice"?"ç·´ç¿’":"æ¼”ç¿’";s.innerHTML=`
      <span class="mode-badge mode-${o.mode}">${l}</span>
      <span class="question-title">${o.title}</span>
    `,s.addEventListener("click",()=>r(o)),e.appendChild(s)}i.appendChild(e),n.appendChild(i)}class L{id;name;type;parent=null;children=[];constructor(t,r,i){this.id=t,this.name=r,this.type=i}addChild(t){if(this.type!=="folder")throw new Error("Cannot add child to a file");t.parent?.removeChild(t),t.parent=this,this.children.push(t)}removeChild(t){this.children=this.children.filter(r=>r!==t),t.parent=null}}class O{root;allNodes;constructor(){this.root=new L("root","root","folder"),this.allNodes=new Map}loadQuestion(t){this.root=new L("root","root","folder"),this.allNodes=new Map;for(const r of t.items){const i=new L(r.id,r.name,r.type);this.allNodes.set(r.id,i),this.root.addChild(i)}}moveNode(t,r){const i=this.allNodes.get(t),e=r==="root"?this.root:this.allNodes.get(r);return!i||!e||e.type!=="folder"?!1:(e.addChild(i),!0)}buildCurrentTree(t=this.root){const r={};for(const i of t.children)i.type==="folder"?r[i.name]={type:"folder",children:this.buildCurrentTree(i)}:r[i.name]={type:"file"};return r}checkAnswer(t){const r=[],i=[];return this.compareTree(this.root,t,r,i),{correct:r,incorrect:i}}compareTree(t,r,i,e){for(const o of t.children)if(o.name in r){const s=r[o.name];o.type===s.type?(i.push(o.id),o.type==="folder"&&s.children&&this.compareTree(o,s.children,i,e)):e.push(o.id)}else e.push(o.id)}checkSingleMove(t,r){const i=this.allNodes.get(t);if(!i||!i.parent)return!1;const e=i.parent===this.root?null:i.parent.name;return this.getAnswerAncestors(i.name,i.type,r,[null]).includes(e)}getAnswerAncestors(t,r,i,e){for(const[o,s]of Object.entries(i)){if(o===t&&s.type===r)return e;if(s.type==="folder"&&s.children){const l=this.getAnswerAncestors(t,r,s.children,[...e,o]);if(l.length>0)return l}}return[]}}class F{selection;clipboard;currentFolder;lastSelectedId=null;constructor(t){this.selection=new Set,this.clipboard=new Set,this.currentFolder=t}toggleSelection(t){this.selection.has(t)?this.selection.delete(t):this.selection.add(t)}isSelected(t){return this.selection.has(t)}clearSelection(){this.selection.clear()}cut(){this.clipboard=new Set(this.selection),this.selection.clear()}clearClipboard(){this.clipboard.clear()}navigateToFolder(t){if(t.type!=="folder")throw new Error("Cannot navigate to a file");this.currentFolder=t}selectRange(t,r,i){const e=t.indexOf(r),o=t.indexOf(i);if(e===-1||o===-1)return;const[s,l]=e<o?[e,o]:[o,e];this.selection.clear();for(let d=s;d<=l;d++)this.selection.add(t[d])}setLastSelected(t){this.lastSelectedId=t}getLastSelected(){return this.lastSelectedId}getSelectedIds(){return Array.from(this.selection)}}function P(n,t,r){T(n,t,r)}function T(n,t,r){n.innerHTML="";const i=document.createElement("ul");i.className="tree-list",i.setAttribute("role","tree");const e=document.createElement("li");e.className="tree-item tree-folder",e.dataset.nodeId=t.root.id,e.setAttribute("role","treeitem"),e.setAttribute("aria-label","Desktop (ãƒ•ã‚©ãƒ«ãƒ€)"),e.setAttribute("aria-expanded","true");const o="ğŸ“";e.textContent=`${o} Desktop`,e.addEventListener("dragover",s=>{D(s,e)}),e.addEventListener("dragleave",s=>{A(s,e)}),e.addEventListener("drop",s=>{$(s,t.root.id,e,t,r)}),t.root.children.length>0&&e.appendChild(k(t.root,t,r)),i.appendChild(e),n.appendChild(i)}function k(n,t,r){const i=document.createElement("ul");i.className="tree-list",i.setAttribute("role","tree");for(const e of n.children){const o=document.createElement("li");o.className=`tree-item tree-${e.type}`,o.dataset.nodeId=e.id,o.setAttribute("role","treeitem"),o.setAttribute("aria-label",`${e.name} (${e.type==="folder"?"ãƒ•ã‚©ãƒ«ãƒ€":"ãƒ•ã‚¡ã‚¤ãƒ«"})`),e.type==="folder"&&o.setAttribute("aria-expanded",e.children.length>0?"true":"false");const s=e.type==="folder"?"ğŸ“":"ğŸ“„";o.textContent=`${s} ${e.name}`,e.type==="folder"&&(o.addEventListener("dragover",l=>{D(l,o)}),o.addEventListener("dragleave",l=>{A(l,o)}),o.addEventListener("drop",l=>{$(l,e.id,o,t,r)}),e.children.length>0&&o.appendChild(k(e,t,r))),i.appendChild(o)}return i}function D(n,t){n.preventDefault(),n.stopPropagation(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",t.classList.add("drop-target"))}function A(n,t){n.stopPropagation();const r=t.getBoundingClientRect(),i=n.clientX,e=n.clientY;(i<=r.left||i>=r.right||e<=r.top||e>=r.bottom)&&t.classList.remove("drop-target")}function $(n,t,r,i,e){if(n.preventDefault(),n.stopPropagation(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==t&&i.moveNode(s,t);e&&e()}catch(o){console.error("Tree drop failed:",o)}}function x(n,t,r,i,e){n.innerHTML="",n.classList.add("breadcrumb-view"),n.setAttribute("role","navigation"),n.setAttribute("aria-label","ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ");const s=H(t,r).split(" > "),l=V(t,r);s.forEach((d,a)=>{const c=document.createElement("span");if(c.className="breadcrumb-item",c.textContent=d,c.dataset.depth=a.toString(),c.dataset.folderId=l[a].id,c.setAttribute("role","button"),c.setAttribute("aria-label",`${d}ã«ç§»å‹•`),c.tabIndex=0,c.addEventListener("click",()=>{i(l[a])}),c.addEventListener("dragover",p=>{q(p,c)}),c.addEventListener("dragleave",p=>{K(p,c)}),c.addEventListener("drop",p=>{B(p,l[a].id,c,r,e)}),n.appendChild(c),a<s.length-1){const p=document.createElement("span");p.className="breadcrumb-separator",p.textContent=" > ",n.appendChild(p)}})}function H(n,t){const r=[];let i=n;for(;i&&i!==t.root;)r.unshift(i.name),i=i.parent;return r.unshift("Desktop"),r.join(" > ")}function V(n,t){const r=[];let i=n;for(;i&&i!==t.root;)r.unshift(i),i=i.parent;return r.unshift(t.root),r}function q(n,t){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",t.classList.add("drop-target"))}function K(n,t){t.classList.remove("drop-target")}function B(n,t,r,i,e){if(n.preventDefault(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==t&&i.moveNode(s,t);e&&e()}catch(o){console.error("Breadcrumb drop failed:",o)}}let h=null;function M(n){y();const t=document.createElement("div");t.className="context-menu",t.style.left=`${n.x}px`,t.style.top=`${n.y}px`,n.items.forEach(e=>{const o=document.createElement("div");o.className="context-menu-item",e.disabled&&o.classList.add("disabled"),o.textContent=e.label,o.addEventListener("click",s=>{s.stopPropagation(),e.disabled||(e.onClick(),y())}),t.appendChild(o)}),document.body.appendChild(t),h=t;const r=t.getBoundingClientRect();r.right>window.innerWidth&&(t.style.left=`${window.innerWidth-r.width-10}px`),r.bottom>window.innerHeight&&(t.style.top=`${window.innerHeight-r.height-10}px`);const i=e=>{t.contains(e.target)||(y(),document.removeEventListener("click",i))};setTimeout(()=>{document.addEventListener("click",i)},0)}function y(){h&&h.parentNode&&(h.parentNode.removeChild(h),h=null)}let m=null;function N(n,t,r,i){n.tabIndex=0,R(n,t,r,i),U(n,t,r,i),_(n,r,t,i),Z(n,r,i)}function R(n,t,r,i){const o=document.activeElement?.dataset?.nodeId;if(n.innerHTML="",n.className="icon-view-dom",r.currentFolder.children.forEach(l=>{const d=j(l,r,t,i);n.appendChild(d)}),o){const l=n.querySelector(`[data-node-id="${o}"]`);if(l){l.focus();return}}n.focus()}function j(n,t,r,i){const e=document.createElement("div");e.className="icon-item",e.dataset.nodeId=n.id,e.tabIndex=0,e.draggable=!0,e.setAttribute("role","button"),e.setAttribute("aria-label",`${n.name} (${n.type==="folder"?"ãƒ•ã‚©ãƒ«ãƒ€":"ãƒ•ã‚¡ã‚¤ãƒ«"})`),e.setAttribute("aria-selected",t.isSelected(n.id).toString()),t.isSelected(n.id)&&e.classList.add("selected");const o=document.createElement("div");o.className="icon-symbol",o.textContent=n.type==="folder"?"ğŸ“":"ğŸ“„",e.appendChild(o);const s=document.createElement("div");return s.className="icon-name",s.textContent=n.name,e.appendChild(s),e.addEventListener("click",l=>{e.focus(),z(n.id,l,t,r,i)}),e.addEventListener("dblclick",()=>{n.type==="folder"&&(t.navigateToFolder(n),i())}),e.addEventListener("dragstart",l=>{X(l,n.id,t)}),e.addEventListener("contextmenu",l=>{l.preventDefault(),W(l,n.id,t,r,i)}),n.type==="folder"&&(e.addEventListener("dragover",l=>{Y(l,e)}),e.addEventListener("dragleave",l=>{Q(l,e)}),e.addEventListener("drop",l=>{G(l,n.id,e,r,i)})),e}function z(n,t,r,i,e){const s=r.currentFolder.children.map(l=>l.id);if(t.ctrlKey||t.metaKey)r.toggleSelection(n),r.setLastSelected(n);else if(t.shiftKey){const l=r.getLastSelected();l?r.selectRange(s,l,n):(r.clearSelection(),r.toggleSelection(n)),r.setLastSelected(n)}else r.clearSelection(),r.toggleSelection(n),r.setLastSelected(n);e()}function J(n,t){const r=document.createElement("div");r.className="drag-preview";const i=3,e=Math.min(n.length,i);for(let o=0;o<e;o++){const s=t.currentFolder.children.find(c=>c.id===n[o]);if(!s)continue;const l=document.createElement("div");l.className="drag-preview-item",l.style.top=`${o*4}px`,l.style.left=`${o*4}px`;const d=document.createElement("span");d.className="drag-preview-icon",d.textContent=s.type==="folder"?"ğŸ“":"ğŸ“„",l.appendChild(d);const a=document.createElement("span");a.className="drag-preview-name",a.textContent=s.name,l.appendChild(a),r.appendChild(l)}if(n.length>i){const o=document.createElement("div");o.className="drag-preview-badge",o.textContent=`+${n.length-i}`,r.appendChild(o)}return r}function X(n,t,r){if(!n.dataTransfer)return;let i;r.isSelected(t)?i=r.getSelectedIds():i=[t],n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",JSON.stringify(i));const e=J(i,r);document.body.appendChild(e),n.dataTransfer.setDragImage(e,10,10),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},0)}function Y(n,t){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move",t.classList.add("drop-target"))}function Q(n,t){const r=t.getBoundingClientRect(),i=n.clientX,e=n.clientY;(i<=r.left||i>=r.right||e<=r.top||e>=r.bottom)&&t.classList.remove("drop-target")}function G(n,t,r,i,e){if(n.preventDefault(),r.classList.remove("drop-target"),!!n.dataTransfer)try{const o=JSON.parse(n.dataTransfer.getData("text/plain"));for(const s of o)s!==t&&i.moveNode(s,t);e()}catch(o){console.error("Drop failed:",o)}}function W(n,t,r,i,e){r.isSelected(t)||(r.clearSelection(),r.toggleSelection(t),r.setLastSelected(t),e()),M({x:n.clientX,y:n.clientY,items:[{label:"åˆ‡ã‚Šå–ã‚Š",onClick:()=>{r.cut(),e()}},{label:"è²¼ã‚Šä»˜ã‘",disabled:r.clipboard.size===0,onClick:()=>{C(r,i,e)}}]})}function _(n,t,r,i){n.addEventListener("contextmenu",e=>{e.target.closest(".icon-item")||(e.preventDefault(),M({x:e.clientX,y:e.clientY,items:[{label:"è²¼ã‚Šä»˜ã‘",disabled:t.clipboard.size===0,onClick:()=>{C(t,r,i)}}]}))})}function Z(n,t,r){n.addEventListener("click",i=>{i.target.closest(".icon-item")||t.selection.size>0&&(t.clearSelection(),r())})}function U(n,t,r,i){m&&n.removeEventListener("keydown",m),m=e=>{(e.ctrlKey||e.metaKey)&&e.key==="x"&&(e.preventDefault(),r.selection.size>0&&(r.cut(),i())),(e.ctrlKey||e.metaKey)&&e.key==="v"&&(e.preventDefault(),r.clipboard.size>0&&C(r,t,i))},n.addEventListener("keydown",m)}function C(n,t,r){const i=Array.from(n.clipboard),e=n.currentFolder.id==="root"?"root":n.currentFolder.id;for(const o of i)t.moveNode(o,e);n.clearClipboard(),r()}function ee(n){m&&(n.removeEventListener("keydown",m),m=null),y()}let f=null,u=null,w=null;function te(n,t,r,i){f=new O,f.loadQuestion(t),u=new F(f.root);const e=document.createElement("div");e.className="game-view",e.innerHTML=`
    <div class="instruction-area">
      <h2>${t.title}</h2>
      <ul class="instructions">
        ${t.instructions.map(c=>`<li>${c}</li>`).join("")}
      </ul>
    </div>
    <div class="main-area">
      <div class="breadcrumb-panel" id="breadcrumb-panel"></div>
      <div class="tree-panel" id="tree-panel"></div>
      <div class="icon-panel" id="icon-panel"></div>
    </div>
    <div class="action-area">
      ${t.mode==="exercise"?'<button id="check-btn" class="btn-primary">ç­”ãˆåˆã‚ã›</button>':""}
      <button id="back-btn" class="btn-secondary">å•é¡Œé¸æŠã«æˆ»ã‚‹</button>
    </div>
  `,n.appendChild(e);const o=e.querySelector("#breadcrumb-panel"),s=e.querySelector("#tree-panel"),l=e.querySelector("#icon-panel");w=l;const d=c=>{u.navigateToFolder(c),a()},a=()=>{if(x(o,u.currentFolder,f,d,a),T(s,f,a),N(l,f,u,a),t.mode==="practice"){const c=f.checkAnswer(t.answer);c.incorrect.length===0&&c.correct.length>0&&r(c)}};x(o,u.currentFolder,f,d,a),P(s,f,a),N(l,f,u,a),t.mode==="exercise"&&e.querySelector("#check-btn").addEventListener("click",()=>{const c=f.checkAnswer(t.answer);r(c)}),e.querySelector("#back-btn").addEventListener("click",i)}function re(){w&&(ee(w),w=null),f=null,u=null}function ne(n,t,r,i,e){const o=r.correct.length+r.incorrect.length,s=r.correct.length,l=document.createElement("div");l.className="result-view",l.innerHTML=`
    <h2>çµæœ</h2>
    <p class="score">${s} / ${o} æ­£è§£</p>
    <div class="result-items">
      ${t.items.map(d=>{const a=r.correct.includes(d.id);return`<div class="result-item ${a?"result-correct":"result-incorrect"}"><span>${a?"âœ“":"âœ—"}</span> ${d.name}</div>`}).join("")}
    </div>
    <div class="result-actions">
      <button id="retry-btn" class="btn-primary">ã‚‚ã†ä¸€åº¦</button>
      <button id="select-btn" class="btn-secondary">å•é¡Œé¸æŠã«æˆ»ã‚‹</button>
    </div>
  `,n.appendChild(l),l.querySelector("#retry-btn").addEventListener("click",e),l.querySelector("#select-btn").addEventListener("click",i)}let b=null,E=null;const v=document.querySelector("#app");function g(n){switch(re(),v.innerHTML="",n){case"select":S(v,I,t=>{b=t,g("game")});break;case"game":b&&te(v,b,t=>{E=t,g("result")},()=>g("select"));break;case"result":b&&E&&ne(v,b,E,()=>g("select"),()=>g("game"));break}}g("select");
